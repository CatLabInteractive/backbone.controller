{"name":"Backbone.Controller","tagline":"Controller for Backbone MV*","body":"Backbone.Controller\r\n===================\r\n\r\n[![Build Status](https://travis-ci.org/artyomtrityak/backbone.controller.png)](https://travis-ci.org/artyomtrityak/backbone.controller)\r\n<a href=\"https://twitter.com/intent/tweet?hashtags=&original_referer=https://github.com/&text=Check+out+Backbone.Controller+for+keeping+controller+logic+separated&tw_p=tweetbutton&url=https://github.com/artyomtrityak/backbone.controller\" target=\"_blank\">\r\n  <img src=\"http://jpillora.com/github-twitter-button/img/tweet.png\"></img>\r\n</a>\r\n\r\nController for Backbone MV*\r\n\r\nKeep controller logic separated, split your routes to controllers.\r\n\r\n## Usage\r\n\r\nDEMO: [Just Test It](https://github.com/artyomtrityak/just-test-it)\r\n\r\nUsage examples:\r\n\r\n###Basic\r\n\r\n```js\r\nvar Controller = Backbone.Controller.extend({\r\n  initialize: function() {\r\n    // do init stuff\r\n  },\r\n\r\n  search: function(query, page) {\r\n    // create search model and view\r\n  }\r\n}); \r\n\r\nvar searchController = new Controller();\r\n```\r\n\r\n###Controller supports default Backbone events\r\n\r\n```js\r\nvar Controller = Backbone.Controller.extend({\r\n  initialize: function() {\r\n    this.model = new Backbone.Model();\r\n    this.listenTo(this.model, 'add', this._onAdd);\r\n  },\r\n\r\n  _onAdd: function(model) {\r\n    // show notification view\r\n  }\r\n}); \r\n\r\nvar catsController = new Controller();\r\n```\r\n\r\n###Controller has remove method for cleanup\r\n\r\nRemove method should do correct remove for all controller views and models, stop listening controller events and clear state.\r\n\r\n```js\r\nvar Controller = Backbone.Controller.extend({\r\n  initialize: function() {\r\n    this.model = new Backbone.Model();\r\n    this.listenTo(this.model, 'add', this._onAdd);\r\n  },\r\n\r\n  _onAdd: function(model) {\r\n    // show notification view\r\n  }\r\n}); \r\n\r\nvar catsController = new Controller();\r\n//...\r\ncatsController.remove();\r\n```\r\n\r\nAlso remove method is calling automatically when user goes from one controller to another. See routing section for details.\r\n\r\n### Controller supports declarative routes definition.\r\n\r\nIt's little more complex than previous examples but can be used to keep all routes separately\r\nwhich is good idea for any size app.\r\n\r\n\r\n```js\r\nvar CatsController = Backbone.Controller.extend({\r\n  routes: {\r\n    'cats': 'list',\r\n    'cats/:id': 'showCat'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  list: function() {\r\n    // show cats list\r\n  },\r\n\r\n  showCat: function(catId) {\r\n    // show cat view\r\n  }\r\n});\r\n\r\nvar DogsController = Backbone.Controller.extend({\r\n  routes: {\r\n    '': 'list',\r\n    'dogs': 'list',\r\n    'dogs/:id': 'showDog'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  list: function() {\r\n    // show dogs list\r\n  },\r\n\r\n  showDog: function(catId) {\r\n    // show cat view\r\n  },\r\n\r\n  remove: functin() {\r\n    // cleanup\r\n  }\r\n});\r\n\r\nvar Application = Backbone.Router.extend({\r\n  controllers: {},\r\n\r\n  initialize: function() {\r\n    this.controllers.cats = new CatsController({router: this});\r\n    this.controllers.dogs = new DogsController({router: this});\r\n\r\n    Backbone.history.start();\r\n  }\r\n});\r\n```\r\n\r\nThe main idea - pass `{router: routerInstance}` as controller option.\r\nThis allows to define controller specific routes in separated controllers.\r\n\r\nWhen url changes from `#dogs` / `#dogs/:id` to any route which defined in another controller, remove method is calling automatically.\r\n\r\nThis case controller should clear state, remove controller specific views and models.\r\n\r\n### Controller can automatically add router without creating Backbone.Router instance\r\n\r\n```js\r\nvar CatsController = Backbone.Controller.extend({\r\n  routes: {\r\n    'cats': 'list',\r\n    'cats/:id': 'showCat'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  list: function() {\r\n    // show cats list\r\n  },\r\n\r\n  showCat: function(catId) {\r\n    // show cat view\r\n  }\r\n});\r\n\r\nvar DogsController = Backbone.Controller.extend({\r\n  routes: {\r\n    '': 'list',\r\n    'dogs': 'list',\r\n    'dogs/:id': 'showDog'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  list: function() {\r\n    // show dogs list\r\n  },\r\n\r\n  showDog: function(catId) {\r\n    // show cat view\r\n  }\r\n});\r\n\r\nvar cats = new CatsController({router: true});\r\nvar dogs = new DogsController({router: true});\r\n```\r\n\r\n### Before / after routing\r\n\r\nController automatically calls `onBeforeRoute` / `onAfterRoute` functions when processing routes.\r\n\r\n```js\r\nvar DogsController = Backbone.Controller.extend({\r\n  routes: {\r\n    '': 'list',\r\n    'dogs': 'list'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  onBeforeRoute: function(url, param1, param2, ...) {\r\n    // called before `#dogs` / `#` routes\r\n    // Set some state variables, create controller layout etc\r\n  },\r\n\r\n  onAfterRoute: function(url, param1, param2, ...) {\r\n    // called after `#dogs` / `#` routes\r\n  },\r\n\r\n  list: function() {\r\n    // show dogs list\r\n  }\r\n});\r\n\r\nvar dogs = new DogsController({router: true});\r\n\r\n\r\n//Cancel route\r\nvar DogsController = Backbone.Controller.extend({\r\n  routes: {\r\n    'dogs': 'list',\r\n    'dogs/:id': 'showDog'\r\n  },\r\n\r\n  initialize: function() {\r\n    // do some init stuff\r\n  },\r\n\r\n  list: function() {\r\n    // show dogs list\r\n  },\r\n\r\n  showDog: function(catId) {\r\n    // show cat view\r\n  },\r\n  onBeforeRoute : function(url) {\r\n    console.log('before route');\r\n    var deferred = Q.defer();\r\n\r\n    setTimeout(function() {\r\n      deferred.resolve('ggg');\r\n    }, 2000);\r\n\r\n    return deferred.promise;\r\n    //return false;\r\n  },\r\n  onAfterRoute : function() {\r\n    console.log('afterRoute');\r\n  }\r\n});\r\n\r\nvar dogs = new DogsController({router : true});\r\nBackbone.history.start();\r\n```\r\n\r\n### Redirecting to another route\r\n\r\nIf declarative routing has been used in project, you don't have access directly to Router instance.\r\nBackbone Controller provides Controller.navigate method as proxy for Backbone.Router.navigate method.\r\n\r\n```js\r\nvar DogsController = Backbone.Controller.extend({\r\n  routes: {\r\n    'dogs': 'list'\r\n  },\r\n\r\n  list: function() {\r\n    // show dogs list\r\n    // if something\r\n    this.navigate('cats/', {trigger: true});\r\n  }\r\n});\r\n\r\nvar dogs = new DogsController({router: true});\r\n```\r\n\r\n## Dependencies loading\r\n\r\n### Require.js AMD\r\n\r\n```js\r\nrequirejs.config({\r\n  baseUrl: 'static/',\r\n  urlArgs: 'bust=' +  Date.now(),\r\n  paths: {\r\n    jquery: 'assets/js/jquery',\r\n    underscore: 'assets/js/underscore',\r\n    backbone: 'assets/js/backbone',\r\n    controller: 'assets/js/backbone.controller'\r\n  },\r\n\r\n  shim: {\r\n    backbone: {\r\n      deps: ['underscore', 'jquery'],\r\n      exports: 'Backbone'\r\n    },\r\n    controller: {\r\n      deps: ['underscore', 'backbone']\r\n    },\r\n    app: ['controller']\r\n  }\r\n});\r\n```\r\n\r\n### CommonJS\r\n\r\n```js\r\nvar Controller = require('controller');\r\n// or require Backbone, both fine\r\n\r\nvar HomeController = Controller.extend({\r\n  ...\r\n});\r\n```\r\n\r\n### Old style\r\n\r\n```html\r\n<script src=\"assets/js/jquery.js\" />\r\n<script src=\"assets/js/underscore.js\" />\r\n<script src=\"assets/js/backbone.js\" />\r\n<script src=\"assets/js/backbone.controller.js\" />\r\n```\r\n\r\n### Bower\r\n\r\n```sh\r\nbower install backbone.controller\r\n```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}